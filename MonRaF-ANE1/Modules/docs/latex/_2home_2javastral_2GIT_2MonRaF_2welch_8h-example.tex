\hypertarget{_2home_2javastral_2GIT_2MonRaF_2welch_8h-example}{}\doxysection{/home/javastral/\+G\+I\+T/\+Mon\+Ra\+F/welch.\+h}
Calcula la Densidad Espectral de Potencia (P\+SD) de Welch para señales complejas.\+Esta función aplica el método de Welch para calcular la P\+SD de una señal compleja de entrada. Divide la señal en segmentos superpuestos, aplica una ventana de Hamming a cada segmento, realiza la Transformada de Fourier en cada segmento, y promedia las potencias espectrales.


\begin{DoxyParams}{Parámetros}
{\em signal} & Puntero a la señal de entrada de tipo {\ttfamily complex double}. \\
\hline
{\em N\+\_\+signal} & Tamaño de la señal de entrada. \\
\hline
{\em fs} & Frecuencia de muestreo de la señal de entrada. \\
\hline
{\em segment\+\_\+length} & Longitud de cada segmento en el que se divide la señal. \\
\hline
{\em overlap} & Factor de solapamiento entre segmentos (0 a 1). \\
\hline
{\em f\+\_\+out} & Puntero al arreglo donde se almacenarán las frecuencias de salida. \\
\hline
{\em P\+\_\+welch\+\_\+out} & Puntero al arreglo donde se almacenarán los valores calculados de la P\+SD.\\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Nota}
Es necesario liberar la memoria reservada para la F\+FT usando {\ttfamily fftw\+\_\+destroy\+\_\+plan} y {\ttfamily fftw\+\_\+free}.
\end{DoxyNote}

\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keywordtype}{size\_t} N\_signal = 1024;}
\DoxyCodeLine{complex \textcolor{keywordtype}{double} signal[N\_signal];}
\DoxyCodeLine{\textcolor{keywordtype}{double} fs = 1000.0;}
\DoxyCodeLine{\textcolor{keywordtype}{int} segment\_length = 256;}
\DoxyCodeLine{\textcolor{keywordtype}{double} overlap = 0.5;}
\DoxyCodeLine{\textcolor{keywordtype}{double} f\_out[segment\_length];}
\DoxyCodeLine{\textcolor{keywordtype}{double} P\_welch\_out[segment\_length];}
\DoxyCodeLine{welch\_psd\_complex(signal, N\_signal, fs, segment\_length, overlap, f\_out, P\_welch\_out);}
\end{DoxyCode}



\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{preprocessor}{\#ifndef WELCH\_H}}
\DoxyCodeLine{\textcolor{preprocessor}{\#define WELCH\_H}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{preprocessor}{\#include <stddef.h>}   \textcolor{comment}{// Para size\_t}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include <complex.h>}  \textcolor{comment}{// Para el tipo double complex}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{preprocessor}{\#define PI 3.14159265358979323846}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keywordtype}{void} \mbox{\hyperlink{welch_8c_a7782130f6fb79d8dd195716ae2e85281}{generate\_hamming\_window}}(\textcolor{keywordtype}{double}* window, \textcolor{keywordtype}{int} segment\_length);}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keywordtype}{void} welch\_psd\_complex(complex \textcolor{keywordtype}{double}* signal, \textcolor{keywordtype}{size\_t} N\_signal, \textcolor{keywordtype}{double} fs, }
\DoxyCodeLine{                       \textcolor{keywordtype}{int} segment\_length, \textcolor{keywordtype}{double} overlap, \textcolor{keywordtype}{double}* f\_out, \textcolor{keywordtype}{double}* P\_welch\_out);}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{preprocessor}{\#endif // WELCH\_H}}
\end{DoxyCodeInclude}
 